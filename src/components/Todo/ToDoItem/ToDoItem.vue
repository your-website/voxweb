<template>
    <div class="todo-item">
        <div class="todo-item__container">
            <h3 class="todo-item__content-title">{{ pass }}</h3>
            <button class="todo-item__button-edit" @click="edit">
                <svg class="todo-item__icon-edit" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 501.6 501.6" style="enable-background:new 0 0 501.6 501.6;" xml:space="preserve"><path style="fill:#DF5C4E;" d="M154.408,260.8c6,6,9.6,14.4,9.6,23.2c0,4.8-1.2,9.2-2.8,13.6c12-5.6,27.2-3.6,37.2,6.4c6,6,9.6,14.4,9.6,23.2c0,4.8-1.2,9.6-3.2,14c12-5.6,26.8-3.6,36.8,6.4c8.8,8.8,11.6,21.2,8.4,32.4l244.8-245.6L367.208,6.8l-245.2,245.6c3.2-0.8,6-1.2,9.2-1.2C140.008,251.2,148.408,254.4,154.408,260.8z"/><path style="fill:#E36D60;" d="M411.608,51.2l-244,244c10.8-2.8,22.4,0,30.8,8.4c6,6,9.6,14.4,9.6,23.2c0,2-0.4,3.6-0.4,5.2l242.8-242.4L411.608,51.2z"/> <path style="fill:#DF5C4E;" d="M56.408,456c-0.4,0-0.4,0-0.8,0c-0.8,0-1.6-0.4-1.6-1.2c-0.4-0.8,0-2,0.8-2.4l43.2-19.6l-43.2-42.8 l-46.4,104l103.6-46.4l-11.2-11.2L56.408,456z"/> <g> <path style="fill:#CCCCCC;" d="M111.208,263.2L111.208,263.2L111.208,263.2C111.608,263.2,111.208,263.2,111.208,263.2z"/> <path style="fill:#CCCCCC;" d="M111.208,263.2L111.208,263.2L111.208,263.2L111.208,263.2L111.208,263.2L111.208,263.2z"/> <path style="fill:#CCCCCC;" d="M152.408,303.6L152.408,303.6C152.008,303.6,152.008,303.6,152.408,303.6 C152.008,303.6,152.008,304,152.408,303.6L152.408,303.6C152.008,304,152.008,303.6,152.408,303.6z"/> <path style="fill:#CCCCCC;" d="M152.408,303.6l0.4-0.4C152.408,303.2,152.408,303.6,152.408,303.6L152.408,303.6z"/> <path style="fill:#CCCCCC;" d="M152.008,304L152.008,304L152.008,304L152.008,304L152.008,304z"/> </g> <path style="fill:#F0B551;" d="M238.408,350c-11.2-11.2-29.2-11.2-40.4-0.4l0,0l0,0c-0.8,0.8-2,0.8-2.8,0s-0.8-2,0-2.8l0,0l0,0l0,0 l0,0c5.6-5.6,8.4-12.8,8.4-20.4s-3.2-14.8-8.4-20.4c-10.8-11.2-28.8-11.2-40-0.4l-0.4,0.4l0,0l0,0l0,0c-0.4,0.4-0.8,0.4-1.2,0.4 s-0.8,0-1.2-0.4c-0.8-0.8-0.8-1.6-0.4-2.4v-0.4l0,0l0,0l0,0l0.4-0.4c4.8-5.2,7.6-12,7.6-19.2c0-7.6-2.8-14.8-8.4-20.4 c-5.6-5.6-12.8-8.4-20.4-8.4c-7.2,0-14.4,2.8-19.6,8c0,0,0,0-0.4,0.4v0.4l0,0L56.408,386l59.6,59.6l122.4-54.8h0.4l0.4-0.8 C249.608,378.8,249.608,361.2,238.408,350z"/> <path d="M240.008,396c-1.2,0-2-0.4-2.8-1.2c-1.6-1.6-1.6-4,0-5.6l254.4-255.2L367.208,9.6l-254,254.8c-1.6,1.6-4,1.6-5.6,0 s-1.6-4,0-5.6l256.8-257.6c0.8-0.8,1.6-1.2,2.8-1.2l0,0c1.2,0,2,0.4,2.8,1.2l130,130c1.6,1.6,1.6,4,0,5.6l-257.2,258 C242.008,395.6,241.208,396,240.008,396z"/> <path d="M4.408,501.6c-1.2,0-2-0.4-2.8-1.2c-1.2-1.2-1.6-2.8-0.8-4.4l105.6-235.6c0.8-2,3.2-2.8,5.2-2s2.8,3.2,2,5.2l-101.2,226 l226-101.2c2-0.8,4.4,0,5.2,2s0,4.4-2,5.2L6.008,501.2C5.608,501.6,4.808,501.6,4.408,501.6z"/> <path d="M196.808,352.8c-1.2,0-2-0.4-2.8-1.2c-1.6-1.6-1.6-4,0-5.6c10.4-10.4,10.4-27.6,0-38s-27.6-10.4-38,0c-1.6,1.6-4,1.6-5.6,0 s-1.6-4,0-5.6c13.6-13.6,35.6-13.6,49.2,0c13.6,13.6,13.6,35.6,0,49.2C198.808,352.4,198.008,352.8,196.808,352.8z"/> <path d="M153.208,309.6c-1.2,0-2-0.4-2.8-1.2c-1.6-1.6-1.6-4,0-5.6c10.4-10.4,10.4-27.6,0-38s-27.6-10.4-38,0c-1.6,1.6-4,1.6-5.6,0 s-1.6-4,0-5.6c13.6-13.6,35.6-13.6,49.2,0c13.6,13.6,13.6,35.6,0,49.2C155.208,309.2,154.408,309.6,153.208,309.6z"/> <path d="M240.408,396c-1.2,0-2-0.4-2.8-1.2c-1.6-1.6-1.6-4,0-5.6c10.4-10.4,10.4-26.8-0.4-37.6c-10.4-10.4-27.6-10.4-38,0 c-1.6,1.6-4,1.6-5.6,0s-1.6-4,0-5.6c13.6-13.6,35.6-13.6,49.2,0c13.6,13.6,13.6,35.6,0.4,48.8 C242.408,395.6,241.608,396,240.408,396z"/> <path d="M184.008,278.4c-1.2,0-2-0.4-2.8-1.2c-1.6-1.6-1.6-4,0-5.6l226-226.4c1.6-1.6,4-1.6,5.6,0s1.6,4,0,5.6l-226,226.4 C186.008,278,185.208,278.4,184.008,278.4z"/> <path d="M227.608,322c-1.2,0-2-0.4-2.8-1.2c-1.6-1.6-1.6-4,0-5.6l226-226.8c1.6-1.6,4-1.6,5.6,0s1.6,4,0,5.6l-226,226.8 C229.608,321.6,228.808,322,227.608,322z"/> <path d="M115.208,451.6c-1.2,0-2-0.4-2.8-1.2l-60.8-60.4c-1.6-1.6-1.6-4,0-5.6s4-1.6,5.6,0l60.8,60.4c1.6,1.6,1.6,4,0,5.6 C117.208,451.2,116.408,451.6,115.208,451.6z"/> <path d="M55.608,458.4c-1.6,0-2.8-0.8-3.6-2.4c-0.8-2,0-4.4,2-5.2l45.6-20.8c2-0.8,4.4,0,5.2,2s0,4.4-2,5.2l-45.6,20.8 C56.808,458.4,56.008,458.4,55.608,458.4z"/> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> </svg>
            </button>
        </div>
        <button @click="deleteItem" class="todo-item__button-delete">
            <svg class="todo-item__icon-delete" viewBox="-45 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m271.710938 7.5h-175.144532c-7.945312 0-14.386718 6.441406-14.386718 14.386719v304.949219c0 7.945312 6.441406 14.386718 14.386718 14.386718h228.734375c7.945313 0 14.386719-6.441406 14.386719-14.386718v-251.359376zm0 0" fill="#fafaff"/><path d="m285.359375 21.148438v305.6875c0 7.945312-6.441406 14.386718-14.386719 14.386718h54.328125c7.945313 0 14.386719-6.441406 14.386719-14.386718v-251.359376zm0 0" fill="#e6e6f2"/><path d="m271.710938 68.609375v-61.109375l67.976562 67.976562h-61.109375c-3.792969 0-6.867187-3.074218-6.867187-6.867187zm0 0" fill="#aae1e7"/><path d="m312.210938 504.5h-202.550782c-19.550781 0-35.933594-14.773438-37.949218-34.21875l-34.746094-335.253906h347.9375l-34.746094 335.253906c-2.015625 19.445312-18.398438 34.21875-37.945312 34.21875zm0 0" fill="#3a90c8"/><path d="m330.40625 135.027344-35.691406 344.402344c-1.476563 14.246093-13.480469 25.070312-27.804688 25.070312h45.300782c19.546874 0 35.933593-14.773438 37.945312-34.21875l34.746094-335.253906zm0 0" fill="#2e6c9f"/><path d="m392.734375 178.519531h-363.597656c-11.949219 0-21.636719-9.683593-21.636719-21.632812v-.222657c0-11.949218 9.6875-21.636718 21.636719-21.636718h363.597656c11.949219 0 21.632813 9.6875 21.632813 21.636718v.222657c0 11.949219-9.683594 21.632812-21.632813 21.632812zm0 0" fill="#ffe591"/><path d="m392.734375 135.027344h-33.113281v43.492187h33.113281c11.949219 0 21.632813-9.683593 21.632813-21.632812v-.222657c0-11.949218-9.683594-21.636718-21.632813-21.636718zm0 0" fill="#ffa442"/><g fill="#415f7d"><path d="m130.398438 444.886719c-7.019532 0-12.949219-5.4375-13.449219-12.550781l-13.792969-195.367188c-.523438-7.4375 5.078125-13.890625 12.515625-14.414062 7.453125-.523438 13.890625 5.078124 14.414063 12.515624l13.792968 195.363282c.523438 7.4375-5.078125 13.890625-12.515625 14.417968-.324219.023438-.644531.035157-.964843.035157zm0 0"/><path d="m184.089844 444.886719c-7.308594 0-13.316406-5.835938-13.492188-13.183594l-4.59375-195.367187c-.179687-7.453126 5.722656-13.636719 13.175782-13.8125 7.421874-.214844 13.636718 5.722656 13.8125 13.179687l4.597656 195.367187c.175781 7.453126-5.726563 13.636719-13.179688 13.8125-.105468 0-.214844.003907-.320312.003907zm0 0"/><path d="m237.78125 444.886719c-.109375 0-.214844-.003907-.324219-.003907-7.453125-.175781-13.351562-6.363281-13.179687-13.8125l4.597656-195.367187c.175781-7.347656 6.183594-13.183594 13.488281-13.183594.109375 0 .214844 0 .324219.003907 7.453125.175781 13.351562 6.359374 13.179688 13.8125l-4.597657 195.367187c-.171875 7.34375-6.179687 13.183594-13.488281 13.183594zm0 0"/><path d="m291.46875 444.886719c-.320312 0-.644531-.011719-.964844-.035157-7.4375-.523437-13.039062-6.980468-12.515625-14.417968l13.792969-195.367188c.523438-7.433594 6.960938-13.035156 14.414062-12.511718 7.4375.523437 13.039063 6.976562 12.515626 14.414062l-13.792969 195.367188c-.5 7.113281-6.429688 12.550781-13.449219 12.550781zm0 0"/></g><path d="m200.664062 31.726562h-83.394531c-4.144531 0-7.5 3.355469-7.5 7.5 0 4.140626 3.355469 7.5 7.5 7.5h83.394531c4.144532 0 7.5-3.359374 7.5-7.5 0-4.144531-3.355468-7.5-7.5-7.5zm0 0"/><path d="m200.664062 61.4375h-83.394531c-4.144531 0-7.5 3.359375-7.5 7.5 0 4.144531 3.355469 7.5 7.5 7.5h83.394531c4.144532 0 7.5-3.355469 7.5-7.5 0-4.140625-3.355468-7.5-7.5-7.5zm0 0"/><path d="m130.398438 452.386719c.492187 0 .988281-.019531 1.496093-.054688 5.59375-.394531 10.699219-2.945312 14.378907-7.179687 3.675781-4.238282 5.484374-9.652344 5.085937-15.246094l-13.789063-195.367188c-.816406-11.542968-10.875-20.269531-22.425781-19.46875-5.59375.398438-10.703125 2.945313-14.378906 7.183594-3.675781 4.234375-5.484375 9.648438-5.089844 15.242188l13.792969 195.367187c.769531 10.949219 9.964844 19.523438 20.929688 19.523438zm-18.304688-220.300781c1.046875-1.210938 2.507812-1.9375 4.101562-2.050782.144532-.011718.28125-.015625.421876-.015625 3.121093 0 5.765624 2.421875 5.988281 5.578125l13.792969 195.363282c.113281 1.601562-.402344 3.148437-1.453126 4.355468-1.050781 1.210938-2.511718 1.9375-4.101562 2.050782-3.320312.230468-6.183594-2.285157-6.414062-5.558594l-13.792969-195.367188c-.113281-1.597656.402343-3.144531 1.457031-4.355468zm0 0"/><path d="m184.089844 452.386719c.171875 0 .351562-.003907.5-.007813 5.605468-.132812 10.828125-2.4375 14.699218-6.496094 3.871094-4.0625 5.933594-9.382812 5.800782-14.992187l-4.601563-195.367187c-.132812-5.628907-2.457031-10.871094-6.550781-14.753907-4.074219-3.863281-9.390625-5.894531-14.933594-5.742187-5.609375.128906-10.828125 2.4375-14.699218 6.496094-3.875 4.058593-5.933594 9.382812-5.800782 14.988281l4.597656 195.367187c.265626 11.308594 9.679688 20.507813 20.988282 20.507813zm-8.933594-220.507813c1.105469-1.160156 2.597656-1.820312 4.238281-1.859375h.171875c1.5 0 2.929688.574219 4.042969 1.628907 1.175781 1.117187 1.84375 2.621093 1.882813 4.230468l4.597656 195.367188c.039062 1.601562-.550782 3.121094-1.65625 4.28125-1.105469 1.160156-2.597656 1.820312-4.226563 1.855468l-.117187.003907c-3.230469 0-5.917969-2.628907-5.992188-5.859375l-4.597656-195.367188c-.039062-1.601562.550781-3.125 1.65625-4.28125zm0 0"/><path d="m237.253906 452.378906c.175782.003906.351563.007813.523438.007813 11.308594 0 20.722656-9.199219 20.988281-20.507813l4.597656-195.367187c.132813-5.605469-1.929687-10.929688-5.800781-14.988281-3.871094-4.058594-9.089844-6.367188-14.671875-6.496094-.175781-.003906-.351563-.007813-.527344-.007813-11.304687 0-20.71875 9.199219-20.984375 20.503907l-4.597656 195.367187c-.132812 5.609375 1.925781 10.933594 5.796875 14.992187 3.875 4.054688 9.09375 6.363282 14.675781 6.496094zm-5.476562-21.132812 4.597656-195.367188c.074219-3.230468 2.761719-5.859375 5.988281-5.859375l.148438.003907c1.601562.035156 3.09375.695312 4.199219 1.855468 1.105468 1.15625 1.695312 2.679688 1.65625 4.28125l-4.597657 195.367188c-.074219 3.230468-2.761719 5.855468-5.992187 5.855468h-.144532c-1.601562-.039062-3.09375-.695312-4.199218-1.855468-1.105469-1.160156-1.695313-2.679688-1.65625-4.28125zm0 0"/><path d="m291.46875 452.386719c10.964844 0 20.15625-8.574219 20.933594-19.523438l13.792968-195.367187c.8125-11.550782-7.921874-21.609375-19.472656-22.425782-11.558594-.800781-21.609375 7.925782-22.421875 19.46875l-13.792969 195.367188c-.816406 11.550781 7.917969 21.609375 19.476563 22.429688.5.03125.992187.050781 1.484375.050781zm-6-21.421875 13.792969-195.367188c.222656-3.15625 2.867187-5.578125 5.984375-5.578125.140625 0 .28125.003907.421875.015625 3.300781.234375 5.796875 3.105469 5.5625 6.40625l-13.792969 195.367188c-.21875 3.128906-2.84375 5.578125-5.96875 5.578125-.148438 0-.296875-.007813-.4375-.015625-3.300781-.234375-5.792969-3.109375-5.5625-6.40625zm0 0"/><path d="m392.734375 127.527344h-363.597656c-16.066407 0-29.136719 13.070312-29.136719 29.136718v.222657c0 16.0625 13.070312 29.136719 29.136719 29.136719h363.597656c16.0625 0 29.132813-13.070313 29.132813-29.136719v-.222657c0-16.066406-13.070313-29.136718-29.132813-29.136718zm14.132813 29.359375c0 7.792969-6.339844 14.136719-14.132813 14.136719h-363.597656c-7.796875 0-14.136719-6.34375-14.136719-14.136719v-.222657c0-7.796874 6.339844-14.136718 14.136719-14.136718h363.597656c7.792969 0 14.132813 6.339844 14.132813 14.136718zm0 0"/><path d="m378.0625 201.058594c-4.128906-.425782-7.808594 2.566406-8.234375 6.6875l-27.128906 261.761718c-1.625 15.671876-14.734375 27.492188-30.492188 27.492188h-202.546875c-15.757812 0-28.863281-11.820312-30.488281-27.492188l-27.132813-261.761718c-.425781-4.121094-4.117187-7.125-8.230468-6.6875-4.121094.425781-7.113282 4.113281-6.6875 8.230468l27.128906 261.765626c2.417969 23.34375 21.941406 40.945312 45.410156 40.945312h202.546875c23.46875 0 42.988281-17.601562 45.410157-40.945312l27.128906-261.761719c.429687-4.121094-2.566406-7.808594-6.683594-8.234375zm0 0"/><path d="m82.179688 112.507812c4.144531 0 7.5-3.359374 7.5-7.5v-83.121093c0-3.796875 3.089843-6.886719 6.886718-6.886719h167.644532v53.609375c0 7.921875 6.441406 14.367187 14.363281 14.367187h53.613281v22.019532c0 4.144531 3.355469 7.5 7.5 7.5 4.140625 0 7.5-3.355469 7.5-7.5v-29.519532c0-1.988281-.792969-3.894531-2.199219-5.304687l-67.972656-67.976563c-1.410156-1.40625-3.316406-2.195312-5.304687-2.195312h-175.144532c-12.066406 0-21.886718 9.816406-21.886718 21.886719v83.121093c0 4.140626 3.359374 7.5 7.5 7.5zm197.03125-86.902343 42.367187 42.371093h-42.367187zm0 0"/></svg>
        </button>
        <ul class="todo-item__list">
            <li class="todo-item__ele" v-for="(todo, index) in todos.slice(0, 2)" :key="index">
                <label>
                    <input disabled="true" type="checkbox" v-model="todo.done">
                </label>
                <del v-if="todo.done">{{ todo.text }}</del>
                <span v-else>{{ todo.text }}</span>
            </li>
        </ul>
    </div>
</template>

<script>
import { eventEmitter } from '../../../main'
  export default {
    props: ['pass', 'todo'],
    components: {
    },
    data: function() {
        return {
            todos: Object.assign([], this.todo)
        };
    },
    created() {
        eventEmitter.$on('deleteItemYes', (item) => {
            // save the deleted item to the local storage
            if (item.closest('.todo-list')) {
                const contentTitle = item.closest('.todo-list').querySelector('.todo-list__content-title').textContent
                const editContentTitle = Array.from(item.children).find((item) => {
                    return item.classList.value ===  'todo-item__container';
                })
                this.saveToDo(contentTitle, editContentTitle.querySelector('.todo-item__content-title').textContent);
            }
            // delete item
            item.remove('.todo-item');
        })
    },
    mounted() {
        // draw a page
        if (localStorage.getItem(`todos${this.pass}`)) {
            try {
                this.todos = JSON.parse(localStorage.getItem(`todos${this.pass}`));
            } catch(e) {
                localStorage.removeItem(`todos${this.contentTitle}`);
            }
        }
    },
    methods: {
        edit: function(event) {
            // pass parameters to the edit popup
            const item = event.target.closest('.todo-item__container');
            const itemToDelete = event.target.closest('.todo-item');
            eventEmitter.$emit('editItem', item, this.todos, itemToDelete);
        },
        deleteItem: function() {
            // pass the item to be deleted.
            // call the method in DeleteItem
            const item = event.target.closest('.todo-item');
            eventEmitter.$emit('deletedItem', item);
        },
        saveToDo(title, deleteItem) {
            // save the deleted item to the local storage
            let b = JSON.parse(localStorage.getItem(`todo${title}`));
            const c = b.filter((item) => item != deleteItem)
            const parsedTitle = JSON.stringify(c);
            localStorage.setItem(`todo${title}`, parsedTitle);
        }
    }
  }
</script>

<style lang="scss">
    .todo-item {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        margin-bottom: 10px;
        padding: 5px;
        border: 1px solid #000;
        background-color: rgba(60, 175, 118, 0.274);
    }

    .todo-item__container {
        display: flex;
        justify-content: space-between;
        width: 100%;
    }

    .todo-item__content-title {
        margin: 0;
        font-weight: normal;
        font-size: 18px;
    }

    .todo-item__button-edit {
        cursor: pointer;
        border: none;
        outline: none;
        background-color: transparent;
    }

    .todo-item__button-delete {
        cursor: pointer;
        border: none;
        outline: none;
        background-color: transparent;
    }

    .todo-item__icon-edit {
        height: 20px;
        width: 20px;
    }

    .todo-item__icon-delete {
        height: 20px;
        width: 20px;
    }

    .todo-item__list {
        padding: 0;
    }

    .todo-item__ele {
        list-style: none;
    }
</style>>
